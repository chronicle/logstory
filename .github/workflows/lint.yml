name: Lint

on:
  push:
    branches: [ main, chronicle-main ]
  pull_request:
    branches: [ main, chronicle-main ]

jobs:
  lint:
    runs-on: ubuntu-latest
    name: Lint Python Code

    steps:
    - name: Checkout code
      uses: actions/checkout@v4

    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.11'

    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install ruff

    - name: Run Ruff linter
      run: |
        echo "ğŸ” Running Ruff linter..."
        ruff check . --output-format=github

    - name: Run Ruff formatter check
      run: |
        echo "ğŸ¨ Checking code formatting..."
        ruff format --check --diff .

  check-style:
    runs-on: ubuntu-latest
    name: Check Code Style Consistency

    steps:
    - name: Checkout code
      uses: actions/checkout@v4

    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.11'

    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install ruff

    - name: Check import sorting
      run: |
        echo "ğŸ“¦ Checking import sorting..."
        ruff check --select I .

    - name: Check for common issues
      run: |
        echo "ğŸ”§ Checking for common code issues..."
        ruff check --select E,F,W,N,UP,B,A,C4,SIM,PIE,G .

    - name: Check docstring style (Google)
      run: |
        echo "ğŸ“ Checking docstring style..."
        ruff check --select D .

    - name: Check complexity
      run: |
        echo "ğŸ§® Checking code complexity..."
        ruff check --select C90,PLR .

    - name: Check security issues
      run: |
        echo "ğŸ”’ Checking for security issues..."
        ruff check --select S .