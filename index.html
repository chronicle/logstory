<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head>
<meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="About LogStory Usecases" href="usecase_docs/ReadMe.html" />

    <link rel="shortcut icon" href="_static/LogStory_logo.jpg"/><!-- Generated with Sphinx 8.2.3 and Furo 2024.08.06 -->
<!-- extra <head> content goes here, e.g. analytics scripts -->

        <title>logstory</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=302659d7" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="#"><div class="brand">logstory</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="#">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="_static/LogStory_logo.jpg" alt="Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="usecase_docs/ReadMe.html">About LogStory Usecases</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="usecase_docs/index.html">List of Usecases</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of List of Usecases</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="usecase_docs/RULES_SEARCH_WORKSHOP.html">RULES_SEARCH_WORKSHOP</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="_sources/index.md.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="logstory">
<h1>LogStory<a class="headerlink" href="#logstory" title="Link to this heading">¶</a></h1>
<p>LogStory is used to update timestamps in telemetry (i.e. logs) and then replay them into a <a class="reference external" href="https://cloud.google.com/security/products/security-operations?hl=en">Google Security Operations (SecOps)</a> tenant. Each usecase tells an infosec story, a “Log Story”.</p>
<section id="usecases">
<h2>Usecases<a class="headerlink" href="#usecases" title="Link to this heading">¶</a></h2>
<p>The stories are organized as “usecases”, which always contain events and may contain entities, reference lists, and/or Yara-L 2.0 Detection Rules. Each usecase includes a ReadMe to describe its use.</p>
<p>Only the RULES_SEARCH_WORKSHOP is included witht the PyPI package. Learning about and installing addition usecases is described in <a class="reference internal" href="usecase_docs/ReadMe.html"><span class="std std-doc">usecases</span></a>.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>It is strongly recommended to review each usecase before ingestion rather than importing them all at once.</p>
</div>
</section>
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Link to this heading">¶</a></h2>
<p>Logstory has a command line interface (CLI), written in Python, that is most easily installed from the Python Package Index (PyPI):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>logstory
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">logstory</span></code> CLI interface has subcommands, which take arguments like so:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">logstory</span> <span class="n">replay_usecase</span> <span class="n">RULES_SEARCH_WORKSHOP</span>
</pre></div>
</div>
<p>These are explained in depth later in this doc.</p>
</section>
<section id="configuration">
<h2>Configuration<a class="headerlink" href="#configuration" title="Link to this heading">¶</a></h2>
<p>After the subcommand, Logstory uses Google’s <a class="reference external" href="https://abseil.io/docs/python/quickstart.html">Abseil</a> library for parameterization of the CLI (aka “flags”). Once installed, it is easiest to configure the CLI flags in an <a class="reference external" href="https://abseil.io/docs/python/guides/flags#a-note-about---flagfile">Abseil flagfile</a> like this one:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>logstory replay_usecase RULES_SEARCH_WORKSHOP \
--customer_id=abcdef12-3456-4abc-8def-123456abcdef
--credentials_path=$HOME/.ssh/malachite-abcd1234abcd_ing.json
--timestamp_delta=1d  # optional
</pre></div>
</div>
<section id="customer-id">
<h3>Customer ID<a class="headerlink" href="#customer-id" title="Link to this heading">¶</a></h3>
<p>(Required) This is your tenant’s UUID4, which can be found at:</p>
<p>https://${code}.backstory.chronicle.security/settings/profile</p>
</section>
<section id="credentials-path">
<h3>Credentials Path<a class="headerlink" href="#credentials-path" title="Link to this heading">¶</a></h3>
<p>(Required)  The credentials provided use the <a class="reference external" href="https://cloud.google.com/chronicle/docs/reference/ingestion-api">Google Security Operations Ingestion API</a>. This is <em>NOT</em> the newer RESTful v1alpha Ingestion API (yet, but that is future work).</p>
<p><strong>Getting API authentication credentials</strong></p>
<p>“Your Google Security Operations representative will provide you with a Google Developer Service Account Credential to enable the API client to communicate with the API.”[<a class="reference external" href="https://cloud.google.com/chronicle/docs/reference/ingestion-api#getting_api_authentication_credentials">reference</a>]</p>
</section>
<section id="timestamp-bts">
<h3>Timestamp BTS<a class="headerlink" href="#timestamp-bts" title="Link to this heading">¶</a></h3>
<p>(Optional, default=1d) Updating timestamps for security telemetry is tricky. The .log files in the usecases have timestamps in many formats and we need to update them all to be recent while simultaneously preserving the relative differences between them. For each usecase, LogStory determines the base timestamp “bts” for the first timestamp in the first logfile and all updates are relative to it.</p>
<p>The image below shows that original timestamps on 2023-06-23 (top two subplots) were updated to 2023-09-24, the relative differences between the three timestamps on the first line of the first log file before (top left) and the last line of the logfile (top right) are preserved both interline and intraline on the bottom two subplots. The usecase spans an interval of 5 minutes and 55 seconds both before and after updates.</p>
<p><img alt="My Image Description" src="_images/bts_update.jpg" /></p>
</section>
<section id="timestamp-delta">
<h3>Timestamp Delta<a class="headerlink" href="#timestamp-delta" title="Link to this heading">¶</a></h3>
<p>When timestamp_delta is set to 0d (zero days), only year, month, and day are updated (to today) and the hours, minutes, seconds, and milliseconds are preserved. That hour may be in the future, so when timestamp_delta is set to 1d the year, month, and day are set to today minus 1 day and the hours, minutes, seconds, and milliseconds are preserved.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>For best results, use a cron jobs to run the usecase daily at 12:01am with <code class="docutils literal notranslate"><span class="pre">--timestamp_delta=1d</span></code>.</p>
</div>
<p>You may also provide <code class="docutils literal notranslate"><span class="pre">Nh</span></code> for offsetting by the hour, which is mainly useful if you want to replay the same log file multiple times per day (and prevend deduplication). Likewise, <code class="docutils literal notranslate"><span class="pre">Nm</span></code> offsets by minutes. These can be combined. For example, on the day of writing (Dec 13, 2024)<code class="docutils literal notranslate"><span class="pre">--timestamp_delta=1d1h1m</span></code> changes an original timestamp from/to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">2021</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">01</span><span class="n">T13</span><span class="p">:</span><span class="mi">37</span><span class="p">:</span><span class="mf">42.123</span><span class="n">Z1</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">12</span><span class="n">T12</span><span class="p">:</span><span class="mi">36</span><span class="p">:</span><span class="mf">42.123</span><span class="n">Z1</span>
</pre></div>
</div>
<p>The hour and minute were each offset by -1 and the date is the date of execution -1.</p>
</section>
</section>
<section id="flags-and-flag-files">
<h2>Flags and flag files<a class="headerlink" href="#flags-and-flag-files" title="Link to this heading">¶</a></h2>
<p>Assuming your flagfile is named config.cfg, you can use it to define all of the required flags and then invoke with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">logstory</span> <span class="n">replay_usecase_logtype</span> <span class="n">RULES_SEARCH_WORKSHOP</span> <span class="n">POWERSHELL</span> <span class="o">--</span><span class="n">flagfile</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">cfg</span>
</pre></div>
</div>
<p>That updates timestamps and all uploads from a single logfile in a single usecase. The following updates timestamps and uploads only entities (rather than events) from and overrides the timestamp_delta in the flagfile (if it is specified):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">logstory</span> <span class="n">replay_usecase_logtype</span> <span class="n">RULES_SEARCH_WORKSHOP</span> <span class="n">POWERSHELL</span> <span class="o">--</span><span class="n">flagfile</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">cfg</span> <span class="o">--</span><span class="n">timestamp_delta</span><span class="o">=</span><span class="mi">0</span><span class="n">d</span> <span class="o">--</span><span class="n">entities</span>
</pre></div>
</div>
<p>You can increase verbocity with by prepending the python log level:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">PYTHONLOGLEVEL</span><span class="o">=</span><span class="n">DEBUG</span> <span class="n">logstory</span> <span class="n">replay_usecase</span> <span class="n">RULES_SEARCH_WORKSHOP</span> <span class="o">--</span><span class="n">flagfile</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">cfg</span> <span class="o">--</span><span class="n">timestamp_delta</span><span class="o">=</span><span class="mi">0</span><span class="n">d</span>
</pre></div>
</div>
<p>For more usage, see <code class="docutils literal notranslate"><span class="pre">logstory</span> <span class="pre">--help</span></code></p>
</section>
<section id="id1">
<h2>Usecases<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h2>
<p>Usecases are meant to be self-describing, so check out the metadata in each one.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>It is strongly recommended to review each usecase before ingestion rather than importing them all at once.</p>
</div>
<p>As shown in the <a class="reference external" href="https://storage.googleapis.com/logstory-usecases-20241216/RULES_SEARCH_WORKSHOP/RULES_SEARCH_WORKSHOP.md">ReadMe for the Rules Search Workshop</a>,</p>
<p>If your usecases were distributed via PyPI (rather than git clone), they will be installed in <code class="docutils literal notranslate"><span class="pre">&lt;venv&gt;/site-packages/logstory/usecases</span></code></p>
<p>You can find the absolute path to that usecase dir with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;import os; import logstory; print(os.path.split(logstory.__file__)[0])&#39;</span>
<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">dandye</span><span class="o">/</span><span class="n">miniconda3</span><span class="o">/</span><span class="n">envs</span><span class="o">/</span><span class="n">venv</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.13</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">logstory</span>
</pre></div>
</div>
<section id="adding-more-usecases">
<h3>Adding more usecases<a class="headerlink" href="#adding-more-usecases" title="Link to this heading">¶</a></h3>
<p>We’ve chosen to distribute only a small subset of the available usecases. Should you choose to add more, you should read the metadata and understand the purpose of each one before adding them.</p>
<p>For the PyPI installed package, simply curl the new usecase into the <code class="docutils literal notranslate"><span class="pre">&lt;venv&gt;/site-packages/logstory/usecases</span></code> directory.</p>
<p>For example, first review the ReadMe for the EDR Workshop usecase:
https://storage.googleapis.com/logstory-usecases-20241216/EDR_WORKSHOP/EDR_WORKSHOP.md</p>
<p>Then download the usecase into that dir. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gsutil</span> <span class="n">rsync</span> <span class="o">-</span><span class="n">r</span> \
<span class="n">gs</span><span class="p">:</span><span class="o">//</span><span class="n">logstory</span><span class="o">-</span><span class="n">usecases</span><span class="o">-</span><span class="mi">20241216</span><span class="o">/</span><span class="n">EDR_WORKSHOP</span> \
<span class="o">~/</span><span class="n">miniconda3</span><span class="o">/</span><span class="n">envs</span><span class="o">/</span><span class="n">venv</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.13</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">logstory</span><span class="o">/</span><span class="n">usecases</span><span class="o">/</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is onerous, so I’m going to add somecommands to make it easier.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ToDo</span><span class="p">:</span>
 <span class="o">*</span> <span class="p">[</span> <span class="p">]</span> <span class="n">Upload</span> <span class="n">subset</span> <span class="n">of</span> <span class="n">usecases</span> <span class="n">to</span> <span class="n">a</span> <span class="n">public</span> <span class="n">bucket</span>
   <span class="o">*</span> <span class="p">[</span> <span class="p">]</span> <span class="n">add</span> <span class="n">a</span> <span class="n">management</span> <span class="n">command</span> <span class="n">to</span> <span class="n">download</span> <span class="kn">from</span><span class="w"> </span><span class="nn">bucket</span>
   <span class="o">*</span> <span class="p">[</span> <span class="p">]</span> <span class="n">update</span> <span class="n">readme</span> <span class="k">with</span> <span class="n">how</span> <span class="n">to</span> <span class="n">add</span>
 <span class="o">*</span> <span class="p">[</span> <span class="p">]</span> <span class="n">Add</span> <span class="n">metadata</span> <span class="n">to</span> <span class="n">usecases</span>
   <span class="o">*</span> <span class="p">[</span> <span class="p">]</span> <span class="n">They</span> <span class="n">should</span> <span class="n">be</span> <span class="bp">self</span> <span class="n">documenting</span>
</pre></div>
</div>
</section>
</section>
<section id="contributing">
<h2>Contributing<a class="headerlink" href="#contributing" title="Link to this heading">¶</a></h2>
<p>Interested in contributing? Check out the contributing guidelines. Please note that this project is released with a Code of Conduct. By contributing to this project, you agree to abide by its terms.</p>
</section>
<section id="license">
<h2>License<a class="headerlink" href="#license" title="Link to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">logstory</span></code> was created by Google Cloud Security. It is licensed under the terms of the Apache License 2.0 license.</p>
</section>
<section id="development-and-re-building-for-publication-on-pypi">
<h2>Development and re-building for publication on PyPI<a class="headerlink" href="#development-and-re-building-for-publication-on-pypi" title="Link to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">git</span><span class="nd">@gitlab</span><span class="o">.</span><span class="n">com</span><span class="p">:</span><span class="n">google</span><span class="o">-</span><span class="n">cloud</span><span class="o">-</span><span class="n">ce</span><span class="o">/</span><span class="n">googlers</span><span class="o">/</span><span class="n">dandye</span><span class="o">/</span><span class="n">logstory</span><span class="o">.</span><span class="n">git</span>
<span class="c1"># Edit, edit, edit...</span>
<span class="n">make</span> <span class="n">build</span>
<span class="c1"># ToDo: pub to PyPI command</span>
</pre></div>
</div>
</section>
</section>
<section id="gcp-cloud-run-functions">
<h1>GCP Cloud Run functions<a class="headerlink" href="#gcp-cloud-run-functions" title="Link to this heading">¶</a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">cloudfunctions/</span></code> subdirectory contains Terraform configuration for deploying
the project to GCP Cloud Run functions. This includes:</p>
<ul class="simple">
<li><p>Functions for loading Entities and Events on 3 day and 24 hour schedules</p></li>
<li><p>Scheduler for the above</p></li>
<li><p>GCP Cloud Storage bucket for the usecases</p></li>
<li><p>…</p></li>
</ul>
<section id="prerequisites">
<h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Link to this heading">¶</a></h2>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Do not use GCP CloudShell to run Terraform, use your local machine, a Cloudtop instance (for Googlers), or a Linux VM in GCP.*</p>
</div>
<section id="chronicle-malachite-google-cloud-project-configuration">
<h3>Chronicle (Malachite) Google Cloud project configuration<a class="headerlink" href="#chronicle-malachite-google-cloud-project-configuration" title="Link to this heading">¶</a></h3>
<p>The ingestion API used by LogStory is the <a class="reference external" href="https://cloud.google.com/chronicle/docs/reference/ingestion-api">Google Security Operations Ingestion API</a>.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>Reference documentation for the <a class="reference external" href="https://cloud.google.com/chronicle/docs/reference/ingestion-api">Google Security Operations Ingestion API</a></p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Your Google Security Operations representative will provide you with a Google Developer Service Account Credential to enable the API client to communicate with the API.</p>
</div>
<ul class="simple">
<li><p>A Service Account is required in the <code class="docutils literal notranslate"><span class="pre">malachite-gglxxxx</span></code> Google Cloud project for your Chronicle tenant. Create a new Service Account if needed.</p>
<ul>
<li><p>The Service Account needs the <code class="docutils literal notranslate"><span class="pre">Malachite</span> <span class="pre">Ingestion</span> <span class="pre">Collector</span></code> role assigned to it in order to forward events to Chronicle.</p></li>
<li><p>If you want to use Logstory’s sample rules with Chronicle, the service account also needs the <code class="docutils literal notranslate"><span class="pre">Backstory</span> <span class="pre">Rules</span> <span class="pre">Engine</span> <span class="pre">API</span> <span class="pre">User</span></code> role.</p></li>
</ul>
</li>
</ul>
</section>
<section id="google-cloud-project-configuration">
<h3>Google Cloud project configuration<a class="headerlink" href="#google-cloud-project-configuration" title="Link to this heading">¶</a></h3>
<p>Authenticate to the <a class="reference external" href="https://cloud.google.com/resource-manager/docs/creating-managing-projects">Google Cloud project</a> that is bound to your Chronicle tenant.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gcloud<span class="w"> </span>auth<span class="w"> </span>login
<span class="nv">PROJECT_ID</span><span class="o">=</span>your_project_id_here
gcloud<span class="w"> </span>config<span class="w"> </span><span class="nb">set</span><span class="w"> </span>project<span class="w"> </span><span class="nv">$PROJECT_ID</span>
</pre></div>
</div>
<p>Create a Service Account for use with Terraform and grant it the appropriate permissions.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gcloud<span class="w"> </span>iam<span class="w"> </span>service-accounts<span class="w"> </span>create<span class="w"> </span>terraform<span class="w"> </span>--display-name<span class="o">=</span><span class="s2">&quot;terraform&quot;</span><span class="w"> </span>--description<span class="o">=</span><span class="s2">&quot;terraform&quot;</span>
gcloud<span class="w"> </span>projects<span class="w"> </span>add-iam-policy-binding<span class="w"> </span><span class="nv">$PROJECT_ID</span><span class="w"> </span>--member<span class="w"> </span>serviceAccount:terraform@<span class="nv">$PROJECT_ID</span>.iam.gserviceaccount.com<span class="w"> </span>--role<span class="w">  </span>roles/cloudfunctions.admin
gcloud<span class="w"> </span>projects<span class="w"> </span>add-iam-policy-binding<span class="w"> </span><span class="nv">$PROJECT_ID</span><span class="w"> </span>--member<span class="w"> </span>serviceAccount:terraform@<span class="nv">$PROJECT_ID</span>.iam.gserviceaccount.com<span class="w"> </span>--role<span class="w">  </span>roles/cloudscheduler.admin
gcloud<span class="w"> </span>projects<span class="w"> </span>add-iam-policy-binding<span class="w"> </span><span class="nv">$PROJECT_ID</span><span class="w"> </span>--member<span class="w"> </span>serviceAccount:terraform@<span class="nv">$PROJECT_ID</span>.iam.gserviceaccount.com<span class="w"> </span>--role<span class="w">  </span>roles/iam.securityAdmin
gcloud<span class="w"> </span>projects<span class="w"> </span>add-iam-policy-binding<span class="w"> </span><span class="nv">$PROJECT_ID</span><span class="w"> </span>--member<span class="w"> </span>serviceAccount:terraform@<span class="nv">$PROJECT_ID</span>.iam.gserviceaccount.com<span class="w"> </span>--role<span class="w">  </span>roles/iam.serviceAccountCreator
gcloud<span class="w"> </span>projects<span class="w"> </span>add-iam-policy-binding<span class="w"> </span><span class="nv">$PROJECT_ID</span><span class="w"> </span>--member<span class="w"> </span>serviceAccount:terraform@<span class="nv">$PROJECT_ID</span>.iam.gserviceaccount.com<span class="w"> </span>--role<span class="w">  </span>roles/iam.serviceAccountDeleter
gcloud<span class="w"> </span>projects<span class="w"> </span>add-iam-policy-binding<span class="w"> </span><span class="nv">$PROJECT_ID</span><span class="w"> </span>--member<span class="w"> </span>serviceAccount:terraform@<span class="nv">$PROJECT_ID</span>.iam.gserviceaccount.com<span class="w"> </span>--role<span class="w">  </span>roles/iam.serviceAccountUser
gcloud<span class="w"> </span>projects<span class="w"> </span>add-iam-policy-binding<span class="w"> </span><span class="nv">$PROJECT_ID</span><span class="w"> </span>--member<span class="w"> </span>serviceAccount:terraform@<span class="nv">$PROJECT_ID</span>.iam.gserviceaccount.com<span class="w"> </span>--role<span class="w">  </span>roles/secretmanager.admin
gcloud<span class="w"> </span>projects<span class="w"> </span>add-iam-policy-binding<span class="w"> </span><span class="nv">$PROJECT_ID</span><span class="w"> </span>--member<span class="w"> </span>serviceAccount:terraform@<span class="nv">$PROJECT_ID</span>.iam.gserviceaccount.com<span class="w"> </span>--role<span class="w">  </span>roles/storage.admin
</pre></div>
</div>
<p>Enable the Google APIs in your project that are required to run Logstory.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gcloud<span class="w"> </span>services<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>cloudresourcemanager.googleapis.com
gcloud<span class="w"> </span>services<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>secretmanager.googleapis.com
gcloud<span class="w"> </span>services<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>iam.googleapis.com
gcloud<span class="w"> </span>services<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>cloudfunctions.googleapis.com
gcloud<span class="w"> </span>services<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>run.googleapis.com
gcloud<span class="w"> </span>services<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>cloudscheduler.googleapis.com
gcloud<span class="w"> </span>services<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>artifactregistry.googleapis.com
gcloud<span class="w"> </span>services<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>cloudbuild.googleapis.com
</pre></div>
</div>
<p>In the Google Cloud console, create a key for the newly created <code class="docutils literal notranslate"><span class="pre">terraform</span></code> Service Account. You will update the Terraform configuration files to use this key in an upcoming step.</p>
<p>A working <a class="reference external" href="https://developer.hashicorp.com/terraform/tutorials/gcp-get-started/install-cli">Terraform installation</a> is required.</p>
</section>
</section>
<section id="id2">
<h2>Configuration<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h2>
<ul>
<li><p><a class="reference external" href="https://docs.gitlab.com/ee/gitlab-basics/start-using-git.html#clone-a-repository">Clone this repository</a>.</p></li>
<li><p>If you have your own use cases to replay, add them to the <a class="reference internal" href="usecases.html"><span class="doc std std-doc">usecases</span></a> folder. By default, Logstory will replay all of the use cases in <a class="reference internal" href="usecases.html"><span class="doc std std-doc">usecases</span></a>.</p>
<ul class="simple">
<li><p>Open the <a class="reference internal" href="#./cloudfunction-code/"><span class="xref myst">cloudfunction-code</span></a> folder and review the <code class="docutils literal notranslate"><span class="pre">usecases_events_logtype_map.yaml</span></code> and <code class="docutils literal notranslate"><span class="pre">usecases_entities_logtype_map.yaml</span></code> files under each folder. If you want to disable a use case, just flip the <code class="docutils literal notranslate"><span class="pre">enabled</span></code> flag to <strong>0</strong>.</p></li>
<li><p>If you have new use cases, add them to corresponding <em>.yaml</em> files under each folder depending on the replay frequency.</p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://console.cloud.google.com/storage/">Create a GCS Bucket</a> to save the Terraform state such as <code class="docutils literal notranslate"><span class="pre">TLA-chronicle-logstory-replay-tfstate</span></code>.</p></li>
<li><p>Open <a class="reference internal" href="#./backend.tf"><span class="xref myst"><code class="docutils literal notranslate"><span class="pre">backend.tf</span></code></span></a> with your favorite text editor and change both <code class="docutils literal notranslate"><span class="pre">credentials</span></code> and <code class="docutils literal notranslate"><span class="pre">bucket</span></code> values to yours.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">credentials</span></code> should be set to the path to your Terraform Service Account key file.</p></li>
<li><p>The bucket must have been created previously as it is where you will be storing your Terraform’s state files.</p></li>
</ul>
</li>
<li><p>Open <code class="docutils literal notranslate"><span class="pre">variables.tf</span></code> with your favorite text editor and change the default values to yours including the Chronicle Ingestion API key.</p>
<ul class="simple">
<li><p>Note, the <strong>numeric</strong> Google Cloud project number is required for the <code class="docutils literal notranslate"><span class="pre">gcp_project_number</span></code> variable. You can execute the following <code class="docutils literal notranslate"><span class="pre">gcloud</span></code> command to find it.</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gcloud<span class="w"> </span>projects<span class="w"> </span>list
me:~/chronicle-logstory$<span class="w"> </span>gcloud<span class="w"> </span>projects<span class="w"> </span>list
PROJECT_ID<span class="w">        </span>NAME<span class="w">       </span>PROJECT_NUMBER
chronicle-123456<span class="w">  </span>chronicle<span class="w">  </span><span class="m">101010101010</span>
</pre></div>
</div>
</li>
</ul>
</section>
<section id="deployment">
<h2>Deployment<a class="headerlink" href="#deployment" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>Run <code class="docutils literal notranslate"><span class="pre">sh</span> <span class="pre">bash.sh</span></code> to generate the latest version of Cloud Function codes</p></li>
<li><p>Run the following Terraform commands to initialize, plan, and apply the configuration.</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Verify that the Terraform state file has been uploaded to the GCS bucket after running &#39;terraform init&#39;.</span>
terraform<span class="w"> </span>init
terraform<span class="w"> </span>plan
terraform<span class="w"> </span>apply
</pre></div>
</div>
<p>Navigate to the Cloud Functions and Cloud Scheduler pages in the Google Cloud console and verify that the Logstory artifacts were created.</p>
</section>
<section id="cloud-schedulers">
<h2>Cloud Schedulers<a class="headerlink" href="#cloud-schedulers" title="Link to this heading">¶</a></h2>
<p>Logstory deploys a number of different Cloud Schedulers. Some data is ingested every 24hours and others every 3 days. If you want to ingest data immediately, you can force a run of the Cloud Scheduler job manually. However, we suggest you to run the logs in a specific order, first run the entities and after couple of hours, run the events.</p>
<p>There are some sample rules in this repo that can be deployed into your Chronicle as well. See <a class="reference internal" href="#./rules/"><span class="xref myst">rules</span></a> folder. If you want to deploy the sample rules, just force run the job named <code class="docutils literal notranslate"><span class="pre">TLA-chronicle-rule-creator-XXX</span></code> from Cloud Schedulers.</p>
</section>
<section id="destruction">
<h2>Destruction<a class="headerlink" href="#destruction" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>Run <code class="docutils literal notranslate"><span class="pre">terraform</span> <span class="pre">destroy</span></code></p></li>
<li><p>Delete the GCS Bucket created to store the Terraform state.</p></li>
<li><p>Delete the rules created in your Chronicle SIEM using <a class="reference external" href="https://cloud.google.com/chronicle/docs/reference/detection-engine-api#deleterule">Delete Rule API</a></p></li>
</ul>
</section>
<section id="authors-and-acknowledgment">
<h2>Authors and acknowledgment<a class="headerlink" href="#authors-and-acknowledgment" title="Link to this heading">¶</a></h2>
<p>security-adoption-eng&#64;google.com</p>
</section>
<section id="contents">
<h2>Contents<a class="headerlink" href="#contents" title="Link to this heading">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="usecase_docs/ReadMe.html">About LogStory Usecases</a></li>
<li class="toctree-l1"><a class="reference internal" href="usecase_docs/index.html">List of Usecases</a><ul>
<li class="toctree-l2"><a class="reference internal" href="usecase_docs/RULES_SEARCH_WORKSHOP.html">RULES_SEARCH_WORKSHOP</a></li>
</ul>
</li>
</ul>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="usecase_docs/ReadMe.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">About LogStory Usecases</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025, Google Cloud Security
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">LogStory</a><ul>
<li><a class="reference internal" href="#usecases">Usecases</a></li>
<li><a class="reference internal" href="#installation">Installation</a></li>
<li><a class="reference internal" href="#configuration">Configuration</a><ul>
<li><a class="reference internal" href="#customer-id">Customer ID</a></li>
<li><a class="reference internal" href="#credentials-path">Credentials Path</a></li>
<li><a class="reference internal" href="#timestamp-bts">Timestamp BTS</a></li>
<li><a class="reference internal" href="#timestamp-delta">Timestamp Delta</a></li>
</ul>
</li>
<li><a class="reference internal" href="#flags-and-flag-files">Flags and flag files</a></li>
<li><a class="reference internal" href="#id1">Usecases</a><ul>
<li><a class="reference internal" href="#adding-more-usecases">Adding more usecases</a></li>
</ul>
</li>
<li><a class="reference internal" href="#contributing">Contributing</a></li>
<li><a class="reference internal" href="#license">License</a></li>
<li><a class="reference internal" href="#development-and-re-building-for-publication-on-pypi">Development and re-building for publication on PyPI</a></li>
</ul>
</li>
<li><a class="reference internal" href="#gcp-cloud-run-functions">GCP Cloud Run functions</a><ul>
<li><a class="reference internal" href="#prerequisites">Prerequisites</a><ul>
<li><a class="reference internal" href="#chronicle-malachite-google-cloud-project-configuration">Chronicle (Malachite) Google Cloud project configuration</a></li>
<li><a class="reference internal" href="#google-cloud-project-configuration">Google Cloud project configuration</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id2">Configuration</a></li>
<li><a class="reference internal" href="#deployment">Deployment</a></li>
<li><a class="reference internal" href="#cloud-schedulers">Cloud Schedulers</a></li>
<li><a class="reference internal" href="#destruction">Destruction</a></li>
<li><a class="reference internal" href="#authors-and-acknowledgment">Authors and acknowledgment</a></li>
<li><a class="reference internal" href="#contents">Contents</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=b90c64f4"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    </body>
</html>